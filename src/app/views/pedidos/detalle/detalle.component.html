<section class="content">
  <div class="container-fluid">
    <div class="block-header" *ngFor="let breadscrum of breadscrums">
      <app-breadcrumb [title]="breadscrum.title" [items]="breadscrum.items" [codigoInforme]="''" [active_item]="breadscrum.active">
      </app-breadcrumb>
    </div>
    <div class="row">
      <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
      <!-- DATOS GENERALES -->
        <div class="row counter-box p-3">
          <div class="d-flex justify-content-between align-items-center">
            <h4>Datos Generales</h4>
            <div class="col-md-4 d-flex align-items-center justify-content-center">
              <div class=" bg-c-green order-info-box7 w-100 shadow" style="border-radius: .5rem; padding: .5rem; margin-bottom: .8rem; ">
                <div class="d-flex justify-content-between">
                  <h3 class=" text-end m-b-5 " style="margin-top: .5rem;"><i class="fas fa-ticket-alt float-start" style="margin-top: .2rem; margin-right: .5rem;"> </i> Nro. del Cupón</h3>
                  <h2 class="text-end" style="margin-top: .5rem;">{{ nmrCupon }}</h2>
                </div>
              </div>
            </div>
            <div>
              <button mat-mini-fab color="warn" style="margin: 0 .5rem .5rem .5rem;" #tooltip="matTooltip" matTooltip="Volver">
                <mat-icon class="col-white">arrow_back</mat-icon>
              </button>
              <button id="btn-guardar-datos-empresa" mat-mini-fab class="bg-cyan shadow" style="margin: 0 .5rem .5rem .5rem;" #tooltip="matTooltip" matTooltip="Guardar">
                <mat-icon class="col-white">save</mat-icon>
              </button>
            </div>
          </div>
          <hr>
          <div class="col-md-3 d-flex justify-content-center">
            <mat-form-field color="primary" style="width: 100%;">
              <mat-label>Fecha del Pedido</mat-label>
              <input matInput [matDatepicker]="fecha_pedido" [(ngModel)]="fechaIngresoDate">
              <mat-datepicker-toggle matIconSuffix [for]="fecha_pedido"></mat-datepicker-toggle>
              <mat-datepicker #fecha_pedido color="primary"></mat-datepicker>
            </mat-form-field>
          </div>
          <div class="col-md-3 d-flex justify-content-center">
            <mat-form-field color="primary" style="width: 100%;">
              <mat-label>Fecha de Vencimiento</mat-label>
              <input matInput [matDatepicker]="fecha_vencimiento" [(ngModel)]="fechaVencimientoDate">
              <mat-datepicker-toggle matIconSuffix [for]="fecha_vencimiento"></mat-datepicker-toggle>
              <mat-datepicker #fecha_vencimiento color="primary"></mat-datepicker>
            </mat-form-field>
          </div>
          <div class="col-md-3 d-flex justify-content-center">
            <mat-form-field color="primary" style="width: 100%;">
              <mat-label>Fecha de Venc. Real</mat-label>
              <input matInput [matDatepicker]="fecha_vencimiento_real" [(ngModel)]="fechaVencimientoRealDate">
              <mat-datepicker-toggle matIconSuffix [for]="fecha_vencimiento_real"></mat-datepicker-toggle>
              <mat-datepicker #fecha_vencimiento_real color="primary"></mat-datepicker>
            </mat-form-field>
          </div>
          <div class="col-md-3">
            <mat-form-field style="width: 100%;">
              <mat-label>Idioma</mat-label>
              <mat-select [(ngModel)]="language">
                <mat-option [value]="'E'">
                  <span class="fi fi-es"></span>
                  ESPAÑOL
                </mat-option>
                <mat-option [value]="'I'">
                  <span class="fi fi-us"></span>
                  INGLÉS
                </mat-option>
              </mat-select>
              <a class="btn-traduccion" style="margin: 0 .3rem 0 .3rem;" matSuffix >
                <span class="fi fi-es" style="font-size: 20px" *ngIf="language === 'E'"></span>
                <span class="fi fi-us" style="font-size: 20px" *ngIf="language  === 'I'"></span>
                <span class="fi fi-us" style="background-image: url(./../../../../../../assets/images/us-es.png); font-size: 20px;" *ngIf="language === 'A'"></span>
              </a>
            </mat-form-field>
          </div>
          <div class="col-md-2">
            <mat-form-field class="w-100">
              <mat-label>Informe de</mat-label>
              <mat-select [(ngModel)]="informePara" >
                <mat-option [value]="'E'">Empresa</mat-option>
                <mat-option [value]="'P'">Persona</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col-md-2">
            <mat-form-field class="w-100">
              <mat-label>Tipo de Informe </mat-label>
              <mat-select [(ngModel)]="tipoInforme">
                <mat-option [value]="''"></mat-option>
                <mat-option [value]="'RV'">RV</mat-option>
                <mat-option [value]="'OR'">OR</mat-option>
                <mat-option [value]="'EF'">EF</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col-md-2 d-flex justify-content-center">
            <mat-form-field color="primary" style="width: 100%;">
              <mat-label>A la Fecha</mat-label>
              <input matInput [matDatepicker]="fecha_informe" [(ngModel)]="fechaInformeDate">
              <mat-datepicker-toggle matIconSuffix [for]="fecha_informe"></mat-datepicker-toggle>
              <mat-datepicker #fecha_informe color="primary"></mat-datepicker>
            </mat-form-field>
          </div>
          <div class="col-md-2">
            <mat-form-field class="w-100">
              <mat-label>Tipo de Trámite </mat-label>
              <mat-select [(ngModel)]="tipoTramite">
                <mat-option [value]="''"></mat-option>
                <mat-option [value]="'T1'">T1</mat-option>
                <mat-option [value]="'T2'">T2</mat-option>
                <mat-option [value]="'T3'">T3</mat-option>
              </mat-select>
            </mat-form-field>
          </div>
          <div class="col-md-3 d-flex justify-content-center">
            <div>
              <div><h5>Precio de Informe(US$): <b>25USD</b> </h5></div>
              <div><h5>Ultima Modificación: <b>27/09/2023</b></h5></div>
            </div>
          </div>
        </div>
        <!-- DATOS DEL ABONADO Y DE LA EMPRESA -->
        <div class="row">
          <!-- DATOS DEL ABONADO -->
          <div class="col-md-4 mt-3">
            <div class="counter-box shadow m-1">
              <div class="row">
                <h4>Datos del Abonado</h4>
                <div class="col-md-12 d-flex align-items-center ">
                  <mat-form-field class="w-100 input-readonly" style="margin-right: 1rem;">
                    <mat-label>Abonado</mat-label>
                    <input matInput placeholder="" value="" [(ngModel)]="nombreAbonado" readonly>
                    <button class="btn-traduccion" matSuffix mat-icon-button (click)="buscarAbonado()">
                      <i class="fa-solid fa-magnifying-glass"></i>
                    </button>
                  </mat-form-field>

                  <mat-slide-toggle [(ngModel)]="isChecked" class="mb-3" (click)="revelarNombre()" style="width:10rem; margin-left: 1rem;">Revelar Nombre: {{nombre_abonado}}</mat-slide-toggle>
                </div>
                <div class="col-md-6">
                  <mat-form-field class="w-100">
                    <mat-label>Nro. Referencia</mat-label>
                    <input matInput placeholder="" [(ngModel)]="nmrReferencia" value="" >
                  </mat-form-field>
                </div>
                <div class="col-md-6">
                  <mat-form-field class="w-100 d-flex">
                    <mat-label>Estado</mat-label>
                    <div class="input-container">
                      <input matInput placeholder="" value="" [(ngModel)]="estado" readonly>
                      <div class="circle-inactive" *ngIf="estado === 'INACTIVO'"></div>
                      <div class="circle-active" *ngIf="estado === 'ACTIVO'"></div>
                    </div>
                  </mat-form-field>
                </div>
                <div class="col-md-6">
                  <mat-form-field class="w-100">
                    <mat-label>Crédito Consultado</mat-label>
                    <input matInput placeholder="" value="" [(ngModel)]="creditoConsultado">
                  </mat-form-field>
                </div>
                <div class="col-md-6">
                  <mat-form-field class="w-100">
                    <mat-label>Plazos</mat-label>
                    <input matInput placeholder="" value="" [(ngModel)]="creditoConsultado">
                  </mat-form-field>
                </div>
                <div class="col-md-6">
                  <mat-form-field class="w-100" >
                    <mat-label>Indicaciones del Abonado</mat-label>
                    <textarea matInput placeholder="" style="min-height: 7rem;" [(ngModel)]="indicacionesAbonado"></textarea>
                  </mat-form-field>
                </div>
                <div class="col-md-6">
                  <mat-form-field class="w-100">
                    <mat-label>Datos Adicionales</mat-label>
                    <textarea matInput placeholder="" style="min-height: 7rem;" [(ngModel)]="datosAdicionales"></textarea>
                  </mat-form-field>
                </div>
              </div>
            </div>
          </div>
          <!-- DATOS DE LA EMPRESA/PERSONA -->
          <div class="col-md-8 mt-3">
            <div class="counter-box shadow m-1">
              <!-- FORMULARIO DE EMPRESA -->
              <div *ngIf="informePara === 'E'">
                <h4>Datos de la Empresa a Investigar</h4>
                <div class="row" >
                  <div class="col-md-6">
                    <mat-form-field class="w-100">
                      <mat-label>Razón Social</mat-label>
                      <input matInput [(ngModel)]="razonSocialInforme" (ngModelChange)="buscarPorNombre(buscarPorNombreInforme)">
                    </mat-form-field>
                  </div>
                  <div class="col-md-5">
                    <mat-form-field class="w-100">
                      <mat-label>Nombre Comercial</mat-label>
                      <input matInput [(ngModel)]="nombreComercialInforme">
                    </mat-form-field>
                  </div>
                  <div class="col-md-1">
                    <button class="btn-traduccion bg-blue mt-2" matSuffix mat-mini-fab (click)="buscarEmpresaPersona()">
                      <i class="fa-solid fa-magnifying-glass"></i>
                    </button>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-3">
                    <mat-form-field class="w-100">
                      <mat-label>Tipo Reg. Trib.</mat-label>
                      <input matInput placeholder="" [(ngModel)]="tipoRT" >
                    </mat-form-field>
                  </div>
                  <div class="col-md-3">
                    <mat-form-field class="w-100">
                      <mat-label>Código Reg. Trib.</mat-label>
                      <input matInput [(ngModel)]="codigoRT" >
                    </mat-form-field>
                  </div>
                  <div class="col-md-6">
                    <mat-form-field class="w-100">
                      <mat-label>Email</mat-label>
                      <input matInput [(ngModel)]="correo" >
                    </mat-form-field>
                  </div>
                  <div class="col-md-3">
                    <mat-form-field class="w-100">
                      <mat-label>Continente</mat-label>
                      <mat-select [(ngModel)]="idContinent" (selectionChange)="selectContinente(idContinent)">
                          <mat-option [value]="continente.id" *ngFor="let continente of continentes">{{continente.valor}}</mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>
                  <div class="col-md-3">
                    <mat-form-field class="w-100">
                      <mat-label>País</mat-label>
                      <input type="text" matInput [formControl]="controlPaisesEmpresa" [matAutocomplete]="auto6" [(ngModel)]="countryAbonado" (ngModelChange)="cambioPais(countryAbonado)">
                      <button class="btn-traduccion" matSuffix mat-icon-button (click)="limpiarSeleccionPais()">
                        <span class="fi fi-{{iconoSeleccionado}}" style="font-size: 20px;"></span>
                      </button>
                      <mat-autocomplete #auto6="matAutocomplete" [displayWith]="displayPaisEmpresa" >
                        <mat-option *ngFor="let pais of filterPaisEmpresa | async" [value]="pais">
                          <span class="fi fi-{{pais.bandera}}"></span>
                          {{pais.valor}}
                        </mat-option>
                      </mat-autocomplete>
                    </mat-form-field>
                  </div>
                  <div class="col-md-3">
                    <mat-form-field class="w-100">
                      <mat-label>Ciudad</mat-label>
                      <input matInput placeholder="" [(ngModel)]="ciudad">
                    </mat-form-field>
                  </div>
                  <div class="col-md-3">
                    <mat-form-field class="w-100">
                      <mat-label>Teléfono</mat-label>
                      <input matInput placeholder="" [(ngModel)]="telefono" >
                    </mat-form-field>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-12">
                    <mat-form-field class="w-100">
                      <mat-label>Dirección</mat-label>
                      <input matInput placeholder="" [(ngModel)]="direccion">
                    </mat-form-field>
                  </div>
                  <div class="col-md-12">
                    <mat-form-field class="w-100">
                      <mat-label>Riesgo Crediticio</mat-label>
                      <mat-select [(ngModel)]="idCreditRisk">
                        <mat-option *ngFor="let cCrediticia of calificacionCrediticia" [value]="cCrediticia.id">
                          {{cCrediticia.valor}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>
                </div>
              </div>
              <!-- FORMULARIO DE PERSONA -->
              <div *ngIf="informePara === 'P'">
                <h4>Datos de la Persona a Investigar</h4>
                <div class="row" >
                  <div class="col-md-11">
                    <mat-form-field class="w-100">
                      <mat-label>Apellidos y Nombres</mat-label>
                      <input matInput [(ngModel)]="apellidosNombresInforme">
                    </mat-form-field>
                  </div>
                  <div class="col-md-1">
                    <button class="btn-traduccion bg-blue mt-2" matSuffix mat-mini-fab (click)="buscarEmpresaPersona()">
                      <i class="fa-solid fa-magnifying-glass"></i>
                    </button>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-3">
                    <mat-form-field class="w-100">
                      <mat-label>Tipo Documento</mat-label>
                      <input matInput [(ngModel)]="tipoDI" >
                    </mat-form-field>
                  </div>
                  <div class="col-md-3">
                    <mat-form-field class="w-100">
                      <mat-label>Código de Documento</mat-label>
                      <input matInput [(ngModel)]="codigoDI" >
                    </mat-form-field>
                  </div>
                  <div class="col-md-3">
                    <mat-form-field class="w-100">
                      <mat-label>Registro Tributario(RUC)</mat-label>
                      <input matInput [(ngModel)]="codigoRuc" >
                    </mat-form-field>
                  </div>
                  <div class="col-md-3">
                    <mat-form-field class="w-100">
                      <mat-label>Situación</mat-label>
                      <input matInput [(ngModel)]="situacionRuc" >
                    </mat-form-field>
                  </div>
                  <div class="col-md-3">
                    <mat-form-field class="w-100">
                      <mat-label>Estado Civil</mat-label>
                      <input matInput [(ngModel)]="estadoCivil" >
                    </mat-form-field>
                  </div>
                  <div class="col-md-3">
                    <mat-form-field class="w-100">
                      <mat-label>País</mat-label>
                      <input type="text" matInput [formControl]="controlPaisesPersona" [matAutocomplete]="auto3" [(ngModel)]="paisPersona" >
                      <button class="btn-traduccion" matSuffix mat-icon-button>
                        <span class="fi fi-{{paisPersona.bandera}}" style="font-size: 20px;"></span>
                      </button>
                      <mat-autocomplete #auto3="matAutocomplete" [displayWith]="displayPaisPersona" >
                        <mat-option *ngFor="let pais of filterPaisPersona | async" [value]="pais">
                          <span class="fi fi-{{pais.bandera}}"></span>
                          {{pais.valor}}
                        </mat-option>
                      </mat-autocomplete>
                    </mat-form-field>
                  </div>
                  <div class="col-md-3">
                    <mat-form-field class="w-100">
                      <mat-label>Ciudad</mat-label>
                      <input matInput [(ngModel)]="ciudadPersona">
                    </mat-form-field>
                  </div>
                  <div class="col-md-3">
                    <mat-form-field class="w-100">
                      <mat-label>Teléfono</mat-label>
                      <input matInput [(ngModel)]="telefonoPersona" >
                    </mat-form-field>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-12">
                    <mat-form-field class="w-100">
                      <mat-label>Dirección</mat-label>
                      <input matInput [(ngModel)]="direccionPersona">
                    </mat-form-field>
                  </div>
                  <div class="col-md-12">
                    <mat-form-field class="w-100">
                      <mat-label>Riesgo Crediticio</mat-label>
                      <mat-select [(ngModel)]="idCreditRisk">
                        <mat-option *ngFor="let cCrediticia of calificacionCrediticia" [value]="cCrediticia.id">
                          {{cCrediticia.valor}}
                        </mat-option>
                      </mat-select>
                    </mat-form-field>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- OTROS ABONADOS PIDIERON ESTE INFORME -->
        <div class="row m-0 p-0">
          <div class="col-md-12" >
            <div class="counter-box shadow" style="overflow-x: auto;">
              <h4>Abonados que Pidieron este Informe</h4>
              <table mat-table [dataSource]="dataSource" class="mat-elevation-z8 w-100" >
                <ng-container matColumnDef="{{columnsToDisplay[0]}}">
                  <th mat-header-cell *matHeaderCellDef class="text-center" style="font-size: 18px;"> Tipo </th>
                  <td mat-cell *matCellDef="let report" class="text-center" >
                    <div *ngIf="report[columnsToDisplay[0]] === 'OR'">
                      <div class="badge badge-solid-orange" style="font-size: 16px;">{{report[columnsToDisplay[0]]}}</div>
                    </div>
                    <div *ngIf="report[columnsToDisplay[0]] === 'RV'">
                      <div class="badge badge-solid-green" style="font-size: 16px;">{{report[columnsToDisplay[0]]}}</div>
                    </div>
                  </td>
                </ng-container>

                <ng-container matColumnDef="{{columnsToDisplay[1]}}">
                  <th mat-header-cell *matHeaderCellDef class="text-center" style="font-size: 18px;"> Cupón </th>
                  <td mat-cell *matCellDef="let report" class="text-center" > {{report[columnsToDisplay[1]]}} </td>
                </ng-container>

                <ng-container matColumnDef="{{columnsToDisplay[2]}}">
                  <th mat-header-cell *matHeaderCellDef class="text-center" style="font-size: 18px;"> Nombre Solicitado </th>
                  <td mat-cell *matCellDef="let report" class="text-center" > {{report[columnsToDisplay[2]]}} </td>
                </ng-container>

                <ng-container matColumnDef="{{columnsToDisplay[3]}}">
                  <th mat-header-cell *matHeaderCellDef class="text-center" style="font-size: 18px;"> Despacho </th>
                  <td mat-cell *matCellDef="let report" class="text-center" > {{report[columnsToDisplay[3]]}} </td>
                </ng-container>

                <ng-container matColumnDef="{{columnsToDisplay[4]}}">
                  <th mat-header-cell *matHeaderCellDef class="text-center" style="font-size: 18px;"> Abonado </th>
                  <td mat-cell *matCellDef="let report" class="text-center" > {{report[columnsToDisplay[4]]}} </td>
                </ng-container>

                <ng-container matColumnDef="{{columnsToDisplay[5]}}">
                  <th mat-header-cell *matHeaderCellDef  class="text-center" style="font-size: 18px;"> Trámite </th>
                  <td mat-cell *matCellDef="let report" class="text-center" >
                    <div *ngIf="report[columnsToDisplay[5]] === 'T1'">
                      <div class="badge badge-solid-blue">{{report[columnsToDisplay[5]]}}</div>
                    </div>
                    <div *ngIf="report[columnsToDisplay[5]] === 'T2'">
                      <div class="badge badge-solid-purple">{{report[columnsToDisplay[5]]}}</div>
                    </div>
                    <div *ngIf="report[columnsToDisplay[5]] === 'T3'">
                      <div class="badge badge-solid-cyan">{{report[columnsToDisplay[5]]}}</div>
                    </div>
                  </td>
                </ng-container>

                <ng-container matColumnDef="{{columnsToDisplay[6]}}">
                  <th mat-header-cell *matHeaderCellDef  class="text-center" style="font-size: 18px;"> País </th>
                  <td mat-cell *matCellDef="let report" class="text-center" > {{report.pais.nombre}} <span class="fi fi-{{report.pais['icono']}}" style="font-size: 20px;"></span></td>
                </ng-container>

                <ng-container matColumnDef="{{columnsToDisplay[7]}}">
                  <th mat-header-cell *matHeaderCellDef class="text-center" style="font-size: 18px;"> Balance </th>
                  <td mat-cell *matCellDef="let report" class="text-center" >
                    <mat-checkbox *ngIf="report[columnsToDisplay[7]] === 'SI'" class="example-margin" [checked]="true" [disabled]="true"></mat-checkbox>
                    <mat-checkbox *ngIf="report[columnsToDisplay[7]] === 'NO'" class="example-margin" [checked]="false"  [disabled]="true"></mat-checkbox>
                  </td>
                </ng-container>
                <ng-container matColumnDef="{{columnsToDisplay[8]}}">
                  <th mat-header-cell *matHeaderCellDef class="text-center" style="font-size: 18px;"> Calidad </th>
                  <td mat-cell *matCellDef="let report" class="text-center" > {{report[columnsToDisplay[8]]}} </td>
                </ng-container>
                <ng-container matColumnDef="{{columnsToDisplay[9]}}">
                  <th mat-header-cell *matHeaderCellDef class="text-center" style="font-size: 18px;"> Estado </th>
                  <td mat-cell *matCellDef="let report" class="text-center">
                    <div *ngIf="report[columnsToDisplay[9]]==='PEND. VENCIDO'" >
                      <span class="float-end progress-percent label label-danger shadow" style="width: 170px;">
                        {{report[columnsToDisplay[9]]}}
                      </span>
                    </div>
                    <div *ngIf="report[columnsToDisplay[9]]==='PENDIENTE'" >
                      <span class="float-end progress-percent label label-info m-b-5 shadow" style="width: 170px;">
                        {{report[columnsToDisplay[9]]}}
                      </span>
                    </div>
                    <div *ngIf="report[columnsToDisplay[9]]==='ENVIADO'" >
                      <span class="float-end progress-percent label label-success m-b-5 shadow" style="width: 170px;">
                        {{report[columnsToDisplay[9]]}}
                      </span>
                    </div>
                    <div *ngIf="report.estado==='ENV. VENCIDO'" >
                      <span class="float-end progress-percent label label-warning m-b-5 shadow" style="width: 170px;">
                        {{report[columnsToDisplay[9]]}}
                      </span>
                    </div>
                  </td>
                </ng-container>
                <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
                <tr mat-row *matRowDef="let row; columns: columnsToDisplay;"></tr>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
